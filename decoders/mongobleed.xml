<decoders>
  <!-- MongoDB JSON: Connection accepted -->
  <decoder name="mongodb-json-conn-accepted">
    <prematch>^\{.*"id":22943.*"msg":"Connection accepted"</prematch>
    <!-- Capture IPv4 or bracketed IPv6 from attr.remote -->
    <regex>"remote":"(\[[0-9A-Fa-f:]+\]|[0-9]{1,3}(?:\.[0-9]{1,3}){3}):([0-9]{1,5})"</regex>
    <order>srcip,srcport</order>
  </decoder>
  <!-- MongoDB JSON: Client metadata -->
  <decoder name="mongodb-json-client-metadata">
    <prematch>^\{.*"id":51800.*"msg":"Client metadata"</prematch>
    <regex>"remote":"(\[[0-9A-Fa-f:]+\]|[0-9]{1,3}(?:\.[0-9]{1,3}){3}):([0-9]{1,5})"</regex>
    <order>srcip,srcport</order>
  </decoder>
  <!-- MongoDB JSON: Connection ended/closed -->
  <decoder name="mongodb-json-conn-closed">
    <prematch>^\{.*"id":22944.*"msg":"Connection ended"</prematch>
    <regex>"remote":"(\[[0-9A-Fa-f:]+\]|[0-9]{1,3}(?:\.[0-9]{1,3}){3}):([0-9]{1,5})"</regex>
    <order>srcip,srcport</order>
  </decoder>
</decoders>
